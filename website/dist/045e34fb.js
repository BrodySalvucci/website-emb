import{B as x,C as k,l as g,m as w,j as e,u as v,D as j,r as R,f,v as E,y as M,w as d,t as y,k as C}from"./assets/index-25a0d8c7.js";import{M as L}from"./d10bf97b.js";import{B as S}from"./c766964c.js";const m=new S(x);async function B(r){const t=U(r);if(t==="about:blank")return{title:"about:blank",icon:"none",url:"about:blank"};const s=await m.fetch(t,{redirect:"follow"});if(!s.ok)throw new Error(`Response was not OK. Got ${s.status}`);const a=new DOMParser().parseFromString(`${await s.text()}`,"text/html"),i=document.createElement("base");i.href=s.finalURL,a.head.append(i);let n;const c=a.querySelector('link[rel*="icon"]');c&&c.href!==""?n=c.href:n=new URL("/favicon.ico",t).toString();const p=await m.fetch(n);n=await _(new Blob([await p.arrayBuffer()],{type:p.headers.get("content-type")}));let l=a.title;if(!l){const u=new URL(s.finalURL);l=`${u.host}${u.pathname}${u.search}`}return{icon:n,title:l,url:s.finalURL}}const D=/\s+/,T=/^\w+:/;function U(r){if(r.match(T))return r;if(r.includes(".")&&!r.match(D))return`http://${r}`;throw new Error(k.t("settings:tabMask.validateError"))}async function _(r){const t=new FileReader;return new Promise((s,o)=>{t.addEventListener("load",()=>s(t.result)),t.addEventListener("error",o),t.readAsDataURL(r)})}var h={},$=w;Object.defineProperty(h,"__esModule",{value:!0});var b=h.default=void 0,I=$(g()),P=e,q=(0,I.default)((0,P.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check");b=h.default=q;const F=()=>e.jsx(L,{title:"Tab Cloak Settings"}),G=({layout:r})=>{const{t}=v(["settings","commonError"]),[s,o]=j(),a=R.useRef(null);async function i(){try{r.current.notifications.current({description:t("settings:tabMask.notification.fetching"),type:"info"});const n=await B(a.current.value);a.current.value=n.url,o(n),r.current.notifications.current({description:t("settings:tabMask.notification.set"),type:"success"})}catch(n){console.error(n),r.current.notifications.current({title:t("settings:tabMask.notification.failure"),description:n instanceof Error?n.message:t("commonError:unknownError"),type:"error"})}}return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("section",{children:[e.jsx("p",{children:e.jsx(f,{children:t("settings:tabMask.description")})}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx(f,{children:t("settings:tabMask.urlField")}),":"]}),e.jsx("form",{onSubmit:n=>{n.preventDefault(),i()},children:e.jsxs(E,{className:M.ThemeInputBar,children:[e.jsx("input",{className:d.themePadRight,defaultValue:s.url,placeholder:"https://example.org/",ref:a}),e.jsx(b,{onClick:i,className:y(d.button,d.right)})]})})]}),e.jsx("div",{children:e.jsx(C,{onClick:()=>{o({title:"",icon:"",url:""}),a.current.value="",r.current.notifications.current({description:t("settings:tabMask.notification.reset"),type:"info"})},children:e.jsx(f,{children:t("settings:tabMask.resetButton")})})})]})]})};export{G as default};
//# sourceMappingURL=045e34fb.js.map
