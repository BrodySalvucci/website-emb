import{l as i,m as d,j as e,u as ae,p as re,n as te,r as o,F as se,J as z,G as oe,t as I,f as le,g as ne,s as ce}from"./assets/index-25a0d8c7.js";import{M as ie}from"./d10bf97b.js";import{d as de,r as ue}from"./22b5cfdb.js";import{T as me}from"./1ed2eb02.js";import{a as fe}from"./d3d01167.js";import{d as ve}from"./e676146e.js";const _e="_main_dblar_29",he="_title_dblar_45",xe="_name_dblar_54",je="_shiftRight_dblar_58",pe="_button_dblar_61",be="_frame_dblar_77",ge="_iframeContainer_dblar_84",ye="_iframeCover_dblar_89",$e="_controls_dblar_106",Se="_close_dblar_119",Ne="_control_dblar_106",we="_visuals_dblar_150",Re="_move_dblar_157",Ee="_controlKey_dblar_163",ke="_keySpace_dblar_178",Ce="_keyEnter_dblar_181",Le="_label_dblar_184",Pe="_loading_dblar_214",De="_shimmerWide_dblar_1",Me="_shimmerCard_dblar_1",Ae="_shimmerSmall_dblar_1",a={main:_e,title:he,name:xe,shiftRight:je,button:pe,frame:be,iframeContainer:ge,iframeCover:ye,controls:$e,close:Se,control:Ne,visuals:we,move:Re,controlKey:Ee,keySpace:ke,keyEnter:Ce,label:Le,loading:Pe,shimmerWide:De,shimmerCard:Me,shimmerSmall:Ae};var S={},Ie=d;Object.defineProperty(S,"__esModule",{value:!0});var q=S.default=void 0,ze=Ie(i()),qe=e,Fe=(0,ze.default)((0,qe.jsx)("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown");q=S.default=Fe;var N={},Ke=d;Object.defineProperty(N,"__esModule",{value:!0});var F=N.default=void 0,Oe=Ke(i()),He=e,Te=(0,Oe.default)((0,He.jsx)("path",{d:"m7 14 5-5 5 5z"}),"ArrowDropUp");F=N.default=Te;var w={},Ue=d;Object.defineProperty(w,"__esModule",{value:!0});var K=w.default=void 0,Ve=Ue(i()),Be=e,Ge=(0,Ve.default)((0,Be.jsx)("path",{d:"m14 7-5 5 5 5V7z"}),"ArrowLeft");K=w.default=Ge;var R={},We=d;Object.defineProperty(R,"__esModule",{value:!0});var O=R.default=void 0,Je=We(i()),Qe=e,Xe=(0,Je.default)((0,Qe.jsx)("path",{d:"m10 17 5-5-5-5v10z"}),"ArrowRight");O=R.default=Xe;var E={},Ye=d;Object.defineProperty(E,"__esModule",{value:!0});var H=E.default=void 0,Ze=Ye(i()),ea=e,aa=(0,Ze.default)((0,ea.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");H=E.default=aa;var k={},ra=d;Object.defineProperty(k,"__esModule",{value:!0});var T=k.default=void 0,ta=ra(i()),sa=e,oa=(0,ta.default)((0,sa.jsx)("path",{d:"M23 18V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zM8.5 12.5l2.5 3.01L14.5 11l4.5 6H5l3.5-4.5z"}),"Panorama");T=k.default=oa;var C={},la=d;Object.defineProperty(C,"__esModule",{value:!0});var U=C.default=void 0,na=la(i()),ca=e,ia=(0,na.default)((0,ca.jsx)("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star");U=C.default=ia;var L={},da=d;Object.defineProperty(L,"__esModule",{value:!0});var V=L.default=void 0,ua=da(i()),ma=e,fa=(0,ua.default)((0,ma.jsx)("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}),"StarBorder");V=L.default=fa;var P={},va=d;Object.defineProperty(P,"__esModule",{value:!0});var B=P.default=void 0,_a=va(i()),ha=e,xa=(0,_a.default)((0,ha.jsx)("path",{d:"M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H8v3H6v-3H3v-2h3V8h2v3h3v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"}),"VideogameAsset");B=P.default=xa;async function ja(t,_){switch(_){case"proxy":return await ue(t,"automatic");case"embed":return t;case"flash":return`${ne("compat flash").path}#${ce(t)}`;case"emulator":case"emulator.gba":case"emulator.nes":case"emulator.n64":case"emulator.genesis":return new URL("./html5/webretro/?"+new URLSearchParams({rom:t,core:"autodetect"}),z).toString();default:throw new TypeError(`Unrecognized target: ${_}`)}}const $=({name:t})=>e.jsx(ie,{title:t||"Player",description:t?`${t} on Holy Unblocker.`:void 0}),Na=()=>{const{t}=ae("theatre"),[_]=re(),l=_.get("id");if(!l)throw new Error("Bad ID");const[m,x]=te(),[G,W]=o.useState(()=>m.favorites.includes(l)),[h,J]=o.useState(!1),[j,p]=o.useState(!1),[b,Q]=o.useState(null),[v,X]=o.useState(null),n=o.useRef(null),D=o.useRef(null),[Y,Z]=o.useState(null),M=o.useRef(null),[u,g]=o.useState(!0);if(o.useEffect(()=>{const r=new AbortController;return async function(){let s;const c=new me(se,r.signal);try{s=t("error.player.fetch");const f=await c.show(l);s=void 0,s=t("error.player.resolve");const ee=await ja(new URL(f.src,z).toString(),f.type);if(s=void 0,X(f),Z(ee),!m.seenGames.includes(l)){s=t("error.player.plays"),await c.plays(l);const{seenGames:A}=m;A.push(l),x({...m,seenGames:A}),s=void 0}}catch(f){fe(f)||(console.error(f),Q({cause:s,message:String(f)}))}}(),()=>r.abort()},[l,m,x,t]),o.useEffect(()=>{function r(){u&&n.current&&n.current.focus()}return u&&n.current&&n.current.focus(),document.documentElement.dataset.lockFrameScroll=Number(u).toString(),window.addEventListener("focus",r),()=>{window.removeEventListener("focus",r),delete document.documentElement.dataset.scroll}},[u,n]),o.useEffect(()=>{if(!n.current)return;function r(){u&&g(!1)}return u?document.documentElement.scrollTo(0,0):n.current.blur(),window.addEventListener("click",r),document.documentElement.dataset.lockFrameScroll=Number(u).toString(),()=>{delete document.documentElement.dataset.lockFrameScroll,window.removeEventListener("click",r)}},[v,u]),o.useEffect(()=>{const r=()=>{g(document.fullscreenElement===n.current)};return document.addEventListener("fullscreenchange",r),()=>{document.removeEventListener("fullscreenchange",r)}},[]),b)return e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx(oe,{cause:b.cause,error:b.message,message:t("error.player.errorMessage")})]});if(!v)return e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsxs("main",{className:I(a.main,a.loading),"data-panorama":Number(h),"data-controls":Number(j),children:[e.jsx("div",{className:a.frame}),e.jsxs("div",{className:a.title,children:[e.jsx("h3",{className:a.name}),e.jsx("div",{className:a.shiftRight}),e.jsx("div",{className:a.button}),e.jsx("div",{className:a.button}),e.jsx("div",{className:a.button}),e.jsx("div",{className:a.button})]})]})]});const y=[];for(const r of v.controls){const s=[];for(const c of r.keys)switch(c){case"arrows":s.push(e.jsxs("div",{className:a.move,children:[e.jsx(F,{className:a.controlKey}),e.jsx(K,{className:a.controlKey}),e.jsx(q,{className:a.controlKey}),e.jsx(O,{className:a.controlKey})]},c));break;case"wasd":s.push(e.jsxs("div",{className:a.move,children:[e.jsx("div",{className:a.controlKey,children:"W"}),e.jsx("div",{className:a.controlKey,children:"A"}),e.jsx("div",{className:a.controlKey,children:"S"}),e.jsx("div",{className:a.controlKey,children:"D"})]},c));break;default:s.push(e.jsx("div",{className:I(a.controlKey,a[`key${c}`]),children:c},c));break}y.push(e.jsxs("div",{className:a.control,children:[e.jsx("div",{className:a.visuals,children:s}),e.jsx("span",{className:a.label,children:r.label})]},r.label))}return e.jsxs(e.Fragment,{children:[e.jsx($,{name:v.name}),e.jsxs("main",{className:a.main,"data-panorama":Number(h),"data-controls":Number(j),children:[e.jsxs("div",{className:a.frame,children:[e.jsxs("div",{className:a.iframeContainer,children:[e.jsx("div",{className:a.iframeCover,title:t("click"),onClick:r=>{r.stopPropagation(),g(!0)}}),e.jsx("iframe",{ref:n,title:"Embed",src:Y||void 0})]}),e.jsxs("div",{tabIndex:0,className:a.controls,ref:M,onBlur:r=>{!r.target.contains(r.relatedTarget)&&!D.current.contains(r.relatedTarget)&&p(!1)},children:[e.jsx(H,{className:a.close,onClick:()=>p(!1)}),e.jsx("div",{className:a.controls,children:y})]})]}),e.jsxs("div",{className:a.title,children:[e.jsx("h3",{className:a.name,children:e.jsx(le,{children:v.name})}),e.jsx("div",{className:a.shiftRight}),e.jsx("div",{className:a.button,onClick:()=>{n.current.requestFullscreen()},title:t("fullscreen"),children:e.jsx(de,{})}),y.length!==0&&e.jsx("div",{className:a.button,tabIndex:0,ref:D,onClick:async()=>{p(!j),M.current.focus()},title:t("controls"),children:e.jsx(B,{})}),e.jsx("div",{className:a.button,onClick:()=>{const r=m.favorites,s=r.indexOf(l);s===-1?r.push(l):r.splice(s,1),x({...m,favorites:r}),W(r.includes(l))},title:t("favorite"),children:G?e.jsx(U,{}):e.jsx(V,{})}),e.jsx("div",{className:a.button,onClick:async()=>{J(!h)},title:t("panorama"),children:h?e.jsx(ve,{}):e.jsx(T,{})})]})]})]})};export{Na as default};
//# sourceMappingURL=88d5622d.js.map
