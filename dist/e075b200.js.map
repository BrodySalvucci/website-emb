{"version":3,"file":"e075b200.js","sources":["../../src/SearchBuilder.ts","../../node_modules/@mui/icons-material/OpenInNew.js","../../src/ServiceFrame.tsx","../../src/aboutBlank.ts","../../src/textContent.ts","../../node_modules/@mui/icons-material/NorthWest.js","../../src/ProxyOmnibox.tsx"],"sourcesContent":["export const whitespace = /\\s/;\nexport const httpsProtocol = /^https?:\\/\\//;\n\nexport default class SearchBuilder {\n\tprivate template: string;\n\tconstructor(template: string) {\n\t\tthis.template = template;\n\t}\n\tquery(input: string) {\n\t\tinput = String(input);\n\n\t\tif (input.match(httpsProtocol)) {\n\t\t\treturn input;\n\t\t} else if (input.includes('.') && !input.match(whitespace)) {\n\t\t\treturn `http://${input}`;\n\t\t} else {\n\t\t\treturn this.template.replace('%s', encodeURIComponent(input));\n\t\t}\n\t}\n}\n","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z\"\n}), 'OpenInNew');\nexports.default = _default;","import type { LayoutDump } from './App';\nimport { useGlobalSettings } from './Layout';\nimport { BARE_API } from './consts';\nimport { isError } from './isAbortError';\nimport { Obfuscated } from './obfuscate';\nimport styles from './styles/Service.module.scss';\nimport ChevronLeft from '@mui/icons-material/ChevronLeft';\nimport Fullscreen from '@mui/icons-material/Fullscreen';\nimport OpenInNew from '@mui/icons-material/OpenInNew';\nimport Public from '@mui/icons-material/Public';\nimport { BareClient } from '@tomphttp/bare-client';\nimport { useRef } from 'react';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nexport type ServiceFrameSrc = [src: string, proxySrc: string];\n\nconst ServiceFrame = ({\n\tlayout,\n\tsrc,\n\tclose,\n}: {\n\tlayout: LayoutDump['layout'];\n\tsrc: ServiceFrameSrc | null;\n\t/**\n\t * Callback to handle closing the ServiceFrame.\n\t * Logic should be:\n\t * \t- Clear the src attribute\n\t */\n\tclose: () => void;\n}) => {\n\tconst iframe = useRef<HTMLIFrameElement | null>(null);\n\tconst [firstLoad, setFirstLoad] = useState(false);\n\tconst [revokeIcon, setRevokeIcon] = useState(false);\n\tconst [lastSrc, setLastSrc] = useState('');\n\tconst bare = useMemo(() => new BareClient(BARE_API), []);\n\tconst linksTried = useMemo(() => new WeakMap(), []);\n\tconst [settings] = useGlobalSettings();\n\tconst [title, setTitle] = useState<string | null>(src?.[0] || null);\n\tconst [icon, setIcon] = useState('');\n\tconst { t } = useTranslation();\n\n\tuseEffect(() => {\n\t\tif (src) {\n\t\t\tif (!iframe.current || !iframe.current.contentWindow) return;\n\n\t\t\ttry {\n\t\t\t\tiframe.current.contentWindow.location.href = src[1];\n\t\t\t\tsetLastSrc(src[1]);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(err);\n\t\t\t\tlayout.current!.notifications.current!({\n\t\t\t\t\ttitle: t('error.compatibleProxy'),\n\t\t\t\t\tdescription: isError(err) ? err.message : String(err),\n\t\t\t\t\ttype: 'error',\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif (!iframe.current || !iframe.current.contentWindow) return;\n\t\t\tsetFirstLoad(false);\n\t\t\tsetTitle('');\n\t\t\tsetIcon('');\n\t\t\tiframe.current.contentWindow.location.href = 'about:blank';\n\t\t\tsetLastSrc('about:blank');\n\t\t}\n\t}, [iframe, layout, settings.proxy, src, t]);\n\n\tuseEffect(() => {\n\t\tfunction focusListener() {\n\t\t\tif (!iframe.current || !iframe.current.contentWindow) return;\n\n\t\t\tiframe.current.contentWindow.focus();\n\t\t}\n\n\t\twindow.addEventListener('focus', focusListener);\n\n\t\treturn () => window.removeEventListener('focus', focusListener);\n\t}, [iframe]);\n\n\tconst testProxyUpdate = useCallback(\n\t\tasync function testProxyUpdate() {\n\t\t\tif (!iframe.current || !iframe.current.contentWindow) return;\n\n\t\t\tconst contentWindow = iframe.current\n\t\t\t\t.contentWindow as unknown as typeof globalThis;\n\n\t\t\t// * didn't hook our call to new Function\n\t\t\ttry {\n\t\t\t\tsetLastSrc(contentWindow.location.href);\n\t\t\t} catch (err) {\n\t\t\t\t// possibly an x-frame error\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst location = new contentWindow.Function('return location')();\n\n\t\t\tif (location === contentWindow.location) setTitle(src?.[0] || null);\n\t\t\telse {\n\t\t\t\tconst currentTitle = contentWindow.document.title;\n\n\t\t\t\tsetTitle(currentTitle || location.toString());\n\t\t\t\tconst selector = contentWindow.document.querySelector(\n\t\t\t\t\t'link[rel*=\"icon\"]',\n\t\t\t\t) as HTMLLinkElement | null;\n\n\t\t\t\tconst icon =\n\t\t\t\t\tselector && selector.href !== ''\n\t\t\t\t\t\t? selector.href\n\t\t\t\t\t\t: new URL('/favicon.ico', location).toString();\n\n\t\t\t\tif (!linksTried.has(location)) linksTried.set(location, new Set());\n\n\t\t\t\tif (!linksTried.get(location).has(icon)) {\n\t\t\t\t\tlinksTried.get(location).add(icon);\n\n\t\t\t\t\tconst outgoing = await bare.fetch(icon);\n\n\t\t\t\t\tsetIcon(URL.createObjectURL(await outgoing.blob()));\n\t\t\t\t\tsetRevokeIcon(true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[bare, iframe, linksTried, src],\n\t);\n\n\tuseEffect(() => {\n\t\tconst interval = setInterval(testProxyUpdate, 50);\n\t\ttestProxyUpdate();\n\t\treturn () => clearInterval(interval);\n\t}, [testProxyUpdate]);\n\n\tuseEffect(() => {\n\t\tdocument.documentElement.dataset.service = Number(Boolean(src)).toString();\n\n\t\treturn () => {\n\t\t\tdelete document.documentElement.dataset.service;\n\t\t};\n\t}, [src]);\n\n\treturn (\n\t\t<div className={styles.service}>\n\t\t\t<div className={styles.buttons}>\n\t\t\t\t<ChevronLeft className={styles.button} onClick={close} />\n\t\t\t\t{icon ? (\n\t\t\t\t\t<img\n\t\t\t\t\t\tclassName={styles.icon}\n\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\tsrc={icon}\n\t\t\t\t\t\tonError={() => setIcon('')}\n\t\t\t\t\t\tonLoad={() => {\n\t\t\t\t\t\t\tif (revokeIcon) {\n\t\t\t\t\t\t\t\tURL.revokeObjectURL(icon);\n\t\t\t\t\t\t\t\tsetRevokeIcon(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<Public className={styles.icon} />\n\t\t\t\t)}\n\t\t\t\t<p className={styles.title}>\n\t\t\t\t\t<Obfuscated ellipsis>{title}</Obfuscated>\n\t\t\t\t</p>\n\t\t\t\t<div className={styles.shiftRight}></div>\n\t\t\t\t<a href={lastSrc} className={styles.button}>\n\t\t\t\t\t<OpenInNew />\n\t\t\t\t</a>\n\t\t\t\t<Fullscreen\n\t\t\t\t\tclassName={styles.button}\n\t\t\t\t\tonClick={() => iframe.current && iframe.current.requestFullscreen()}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<iframe\n\t\t\t\tclassName={styles.embed}\n\t\t\t\ttitle=\"embed\"\n\t\t\t\tref={iframe}\n\t\t\t\tdata-first-load={Number(firstLoad)}\n\t\t\t\tonLoad={() => {\n\t\t\t\t\ttestProxyUpdate();\n\n\t\t\t\t\tif (src) {\n\t\t\t\t\t\tsetFirstLoad(true);\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t></iframe>\n\t\t</div>\n\t);\n};\n\nexport default ServiceFrame;\n","const presentAboutBlank = (src: string) => {\n\tconst newWindow = window.open('about:blank');\n\n\tif (!newWindow) throw new Error(`Could not create new window`);\n\n\tnewWindow.addEventListener(\n\t\t'DOMContentLoaded',\n\t\t() => {\n\t\t\tconst iframe = newWindow.document.createElement('iframe');\n\t\t\tiframe.src = src;\n\t\t\t// expand iframe to fit window\n\t\t\tiframe.style.border = 'none';\n\t\t\tiframe.style.position = 'absolute';\n\t\t\tiframe.style.top = '0px';\n\t\t\tiframe.style.left = '0px';\n\t\t\tiframe.style.width = '100%';\n\t\t\tiframe.style.height = '100%';\n\t\t\tnewWindow.document.body.append(iframe);\n\t\t},\n\t\t// immediately attempt to dereference iframe\n\t\t{ once: true },\n\t);\n};\n\nexport default presentAboutBlank;\n","const buffer = /*#__PURE__*/ document.createElement('div');\n\n/**\n * Sanitizes raw HTML using native APIs\n * @param html\n * @returns\n */\nexport default function textContent(html: string) {\n\tbuffer.innerHTML = html;\n\tconst { textContent } = buffer;\n\tbuffer.innerHTML = '';\n\treturn textContent!;\n}\n","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M5 15h2V8.41L18.59 20 20 18.59 8.41 7H15V5H5v10z\"\n}), 'NorthWest');\nexports.default = _default;","import type { LayoutDump } from './App';\nimport { useGlobalSettings } from './Layout';\nimport resolveProxy from './ProxyResolver';\nimport SearchBuilder from './SearchBuilder';\nimport type { ServiceFrameSrc } from './ServiceFrame';\nimport ServiceFrame from './ServiceFrame';\nimport { ThemeInputBar, themeStyles } from './ThemeElements';\nimport presentAboutBlank from './aboutBlank';\nimport { BARE_API } from './consts';\nimport { decryptURL, encryptURL } from './cryptURL';\nimport engines from './engines';\nimport isAbortError, { isFailedToFetch } from './isAbortError';\nimport styles from './styles/ProxyOmnibox.module.scss';\nimport textContent from './textContent';\nimport NorthWest from '@mui/icons-material/NorthWest';\nimport Search from '@mui/icons-material/Search';\nimport { BareClient } from '@tomphttp/bare-client';\nimport clsx from 'clsx';\nimport { createRef, useEffect, useMemo, useRef, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useSearchParams } from 'react-router-dom';\n\nconst ProxyOmnibox = ({\n\tclassName,\n\tplaceholder,\n\tlayout,\n}: {\n\tclassName?: string;\n\tplaceholder?: string;\n\tlayout: LayoutDump['layout'];\n}) => {\n\tconst { t } = useTranslation('proxy');\n\tconst input = useRef<HTMLInputElement | null>(null);\n\tconst inputValue = useRef<string | null>(null);\n\tconst lastInput = useRef<'select' | 'input' | null>(null);\n\tconst [lastSelect, setLastSelect] = useState(-1);\n\tconst [omniboxEntries, setOmniboxEntries] = useState<string[]>([]);\n\tconst [inputFocused, setInputFocused] = useState(false);\n\tconst abort = useRef(new AbortController());\n\tconst bare = useMemo(() => new BareClient(BARE_API), []);\n\tconst [settings] = useGlobalSettings();\n\tconst engine =\n\t\tengines.find((engine) => engine.format === settings.search) || engines[0];\n\tconst [search, setSearch] = useSearchParams();\n\tconst [src, setSrc] = useState<ServiceFrameSrc | null>(null);\n\n\tuseEffect(() => {\n\t\tconst abort = new AbortController();\n\n\t\t(async () => {\n\t\t\t// allow querying eg ?q+hello+world\n\t\t\tif (search.has('q')) {\n\t\t\t\tconst src = new SearchBuilder(engine.format).query(search.get('q')!);\n\t\t\t\tsetSrc([src, await resolveProxy(src, settings.proxy, abort.signal)]);\n\t\t\t}\n\t\t})();\n\n\t\treturn () => abort.abort();\n\t}, [search, setSearch, engine, settings.proxy]);\n\n\tuseEffect(() => {\n\t\t// allow reusing src\n\t\tconst qSrc = search.get('src');\n\t\tif (qSrc) setSrc(JSON.parse(decryptURL(qSrc)));\n\t\t// only do this on the first load bc search.src is updated later:\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, []);\n\n\tuseEffect(() => {\n\t\t// update search.src\n\t\t// this won't trip the previous hook\n\t\tif (src) search.set('src', encryptURL(JSON.stringify(src)));\n\t\telse search.delete('src');\n\n\t\tsetSearch(search);\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [src]);\n\n\tasync function onInput() {\n\t\tif (inputValue.current !== input.current!.value) {\n\t\t\tinputValue.current = input.current!.value;\n\n\t\t\tconst entries: string[] = [];\n\n\t\t\ttry {\n\t\t\t\tabort.current.abort();\n\t\t\t\tabort.current = new AbortController();\n\n\t\t\t\tconst outgoing = await bare.fetch(\n\t\t\t\t\t'https://www.bing.com/AS/Suggestions?' +\n\t\t\t\t\t\tnew URLSearchParams({\n\t\t\t\t\t\t\tqry: input.current!.value,\n\t\t\t\t\t\t\tcvid: '\\u0001',\n\t\t\t\t\t\t\tbareServer: '',\n\t\t\t\t\t\t}),\n\t\t\t\t\t{\n\t\t\t\t\t\tsignal: abort.current.signal,\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tif (!outgoing.ok) {\n\t\t\t\t\tthrow await outgoing.text();\n\t\t\t\t}\n\n\t\t\t\tconst text = await outgoing.text();\n\n\t\t\t\tfor (const [, phrase] of text.matchAll(\n\t\t\t\t\t/<span class=\"sa_tm_text\">(.*?)<\\/span>/g,\n\t\t\t\t))\n\t\t\t\t\tentries.push(phrase);\n\t\t\t} catch (err) {\n\t\t\t\tif (isAbortError(err) || isFailedToFetch(err)) {\n\t\t\t\t\t// likely abort error\n\t\t\t\t\tconsole.error('Error fetching Bare server.');\n\t\t\t\t} else {\n\t\t\t\t\tthrow err;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetOmniboxEntries(entries);\n\t\t}\n\t}\n\n\tasync function searchSubmit() {\n\t\tconst value =\n\t\t\tlastSelect === -1 || lastInput.current === 'input'\n\t\t\t\t? input.current!.value\n\t\t\t\t: textContent(omniboxEntries[lastSelect]);\n\n\t\tinput.current!.value = value;\n\n\t\tconst builder = new SearchBuilder(settings.search);\n\t\tconst src = builder.query(input.current!.value);\n\n\t\tsetInputFocused(false);\n\n\t\tswitch (settings.proxyMode) {\n\t\t\tcase 'embedded':\n\t\t\t\tsetSrc([src, await resolveProxy(src, settings.proxy)]);\n\t\t\t\tbreak;\n\t\t\tcase 'redirect':\n\t\t\t\twindow.location.assign(await resolveProxy(src, settings.proxy));\n\t\t\t\tbreak;\n\t\t\tcase 'about:blank':\n\t\t\t\tpresentAboutBlank(await resolveProxy(src, settings.proxy));\n\t\t\t\tbreak;\n\t\t}\n\n\t\tonInput();\n\t}\n\n\tconst renderSuggested = inputFocused && omniboxEntries.length !== 0;\n\n\tconst form = useRef<HTMLFormElement | null>(null);\n\tconst suggested = useRef<HTMLDivElement | null>(null);\n\n\treturn (\n\t\t<>\n\t\t\t<ServiceFrame src={src} close={() => setSrc(null)} layout={layout} />\n\t\t\t<form\n\t\t\t\tclassName={clsx(styles.omnibox, className)}\n\t\t\t\tdata-suggested={Number(renderSuggested)}\n\t\t\t\tdata-focused={Number(inputFocused)}\n\t\t\t\tonSubmit={(event) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsearchSubmit();\n\t\t\t\t}}\n\t\t\t\tonBlur={(event) => {\n\t\t\t\t\tif (!form.current!.contains(event.relatedTarget)) {\n\t\t\t\t\t\tsetInputFocused(false);\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\tref={form}\n\t\t\t>\n\t\t\t\t<ThemeInputBar className={styles.ThemeInputBar}>\n\t\t\t\t\t<Search className={themeStyles.icon} />\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tplaceholder={\n\t\t\t\t\t\t\tplaceholder ||\n\t\t\t\t\t\t\tt('search', {\n\t\t\t\t\t\t\t\tengine: engine.name,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\trequired={lastSelect === -1}\n\t\t\t\t\t\tautoComplete=\"off\"\n\t\t\t\t\t\tclassName={themeStyles.thinPadLeft}\n\t\t\t\t\t\tref={input}\n\t\t\t\t\t\tonInput={onInput}\n\t\t\t\t\t\tonFocus={() => {\n\t\t\t\t\t\t\tonInput();\n\t\t\t\t\t\t\tsetInputFocused(true);\n\t\t\t\t\t\t\tsetLastSelect(-1);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tonInput();\n\t\t\t\t\t\t\tsetInputFocused(true);\n\t\t\t\t\t\t\tsetLastSelect(-1);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonChange={() => {\n\t\t\t\t\t\t\tlastInput.current = 'input';\n\t\t\t\t\t\t\tsetLastSelect(-1);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonKeyDown={(event) => {\n\t\t\t\t\t\t\tlet preventDefault = true;\n\n\t\t\t\t\t\t\tswitch (event.code) {\n\t\t\t\t\t\t\t\tcase 'Escape':\n\t\t\t\t\t\t\t\t\tsetInputFocused(false);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconst lastI = lastSelect;\n\n\t\t\t\t\t\t\t\t\t\tlet next: number | undefined;\n\n\t\t\t\t\t\t\t\t\t\tswitch (event.code) {\n\t\t\t\t\t\t\t\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\t\t\t\t\t\t\t\tif (lastI >= omniboxEntries.length - 1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tnext = 0;\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tnext = lastI + 1;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\t\t\t\t\t\t\t\tif (lastI <= 0) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tnext = omniboxEntries.length - 1;\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tnext = lastI - 1;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t// no default\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tlastInput.current = 'select';\n\n\t\t\t\t\t\t\t\t\t\tsetLastSelect(next);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpreventDefault = false;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t// no default\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (preventDefault) {\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</ThemeInputBar>\n\t\t\t\t<div\n\t\t\t\t\tref={suggested}\n\t\t\t\t\tclassName={styles.suggested}\n\t\t\t\t\tonMouseLeave={() => {\n\t\t\t\t\t\tsetLastSelect(-1);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{renderSuggested &&\n\t\t\t\t\t\tomniboxEntries.map((entry, i) => {\n\t\t\t\t\t\t\tconst text = createRef<HTMLSpanElement>();\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\ttabIndex={0}\n\t\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\tstyles.option,\n\t\t\t\t\t\t\t\t\t\ti === lastSelect && styles.hover,\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tlastInput.current = 'select';\n\t\t\t\t\t\t\t\t\t\tinput.current!.value = text.current!.textContent!;\n\t\t\t\t\t\t\t\t\t\tsearchSubmit();\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tonMouseOver={() => {\n\t\t\t\t\t\t\t\t\t\tsetLastSelect(i);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Search className={styles.search} />\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName={styles.text}\n\t\t\t\t\t\t\t\t\t\tref={text}\n\t\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t\t\t\t__html: entry,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<NorthWest className={styles.open} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</>\n\t);\n};\n\nexport default ProxyOmnibox;\n"],"names":["whitespace","httpsProtocol","SearchBuilder","template","__publicField","input","_interopRequireDefault","require$$0","OpenInNew","default_1","_createSvgIcon","require$$1","_jsxRuntime","require$$2","_default","ServiceFrame","layout","src","close","iframe","useRef","firstLoad","setFirstLoad","useState","revokeIcon","setRevokeIcon","lastSrc","setLastSrc","bare","useMemo","BareClient","BARE_API","linksTried","settings","useGlobalSettings","title","setTitle","icon","setIcon","t","useTranslation","useEffect","err","isError","focusListener","testProxyUpdate","useCallback","contentWindow","location","currentTitle","selector","outgoing","interval","jsxs","styles","jsx","ChevronLeft","Public","Obfuscated","Fullscreen","presentAboutBlank","newWindow","buffer","textContent","html","NorthWest","ProxyOmnibox","className","placeholder","inputValue","lastInput","lastSelect","setLastSelect","omniboxEntries","setOmniboxEntries","inputFocused","setInputFocused","abort","engine","engines","search","setSearch","useSearchParams","setSrc","resolveProxy","qSrc","decryptURL","encryptURL","onInput","entries","text","phrase","isAbortError","isFailedToFetch","searchSubmit","value","renderSuggested","form","suggested","Fragment","clsx","event","ThemeInputBar","Search","themeStyles","preventDefault","lastI","next","entry","i","createRef"],"mappings":"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","x_google_ignoreList":[1,5]}