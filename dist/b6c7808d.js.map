{"version":3,"file":"b6c7808d.js","sources":["../../node_modules/@mui/icons-material/ChevronRight.js","../../src/TheatreCategory.tsx"],"sourcesContent":["\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\"\n}), 'ChevronRight');\nexports.default = _default;","import CommonError from './CommonError';\nimport type { CategoryData, LoadingCategoryData } from './TheatreCommon';\nimport { isLoading } from './TheatreCommon';\nimport { ItemList, TheatreAPI } from './TheatreCommon';\nimport SearchBar from './TheatreSearchBar';\nimport { ThemeSelect } from './ThemeElements';\nimport { DB_API } from './consts';\nimport isAbortError from './isAbortError';\nimport { Obfuscated } from './obfuscate';\nimport styles from './styles/TheatreCategory.module.scss';\nimport ChevronLeft from '@mui/icons-material/ChevronLeft';\nimport ChevronRight from '@mui/icons-material/ChevronRight';\nimport clsx from 'clsx';\nimport { useEffect, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useSearchParams } from 'react-router-dom';\n\nconst LIMIT = 30;\n\nfunction createLoading(total: number) {\n\tconst loading: LoadingCategoryData = {\n\t\ttotal,\n\t\tentries: [],\n\t\tloading: true,\n\t};\n\n\tfor (let i = 0; i < LIMIT; i++) {\n\t\tloading.entries.push({\n\t\t\tid: i.toString(),\n\t\t\tloading: true,\n\t\t\tcategory: [],\n\t\t});\n\t}\n\n\treturn loading;\n}\n\nconst Category = ({\n\tname,\n\tcategory,\n\tplaceholder,\n\tshowCategory,\n}: {\n\tname: string;\n\tcategory: string;\n\tplaceholder?: string;\n\tshowCategory?: boolean;\n}) => {\n\tconst { t } = useTranslation(['theatre', 'commonError']);\n\tconst [search, setSearch] = useSearchParams();\n\tlet page = parseInt(search.get('page')!);\n\tif (isNaN(page)) page = 0;\n\tconst [lastTotal, setLastTotal] = useState(LIMIT * 2);\n\tconst [data, setData] = useState<CategoryData | null>(null);\n\tconst foundData = data || createLoading(lastTotal);\n\tconst maxPage = Math.floor(foundData.total / LIMIT);\n\tconst [error, setError] = useState<string | null>(null);\n\n\tuseEffect(() => {\n\t\tsetData(null);\n\n\t\tconst abort = new AbortController();\n\n\t\t(async function () {\n\t\t\tlet leastGreatest = false;\n\t\t\tlet sort;\n\n\t\t\tswitch (search.get('sort')) {\n\t\t\t\tcase 'leastPopular':\n\t\t\t\t\tleastGreatest = true;\n\t\t\t\t// fallthrough\n\t\t\t\tcase 'mostPopular':\n\t\t\t\t\tsort = 'plays';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'nameASC':\n\t\t\t\t\tleastGreatest = true;\n\t\t\t\t// fallthrough\n\t\t\t\tcase 'nameDES':\n\t\t\t\t\tsort = 'name';\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst api = new TheatreAPI(DB_API, abort.signal);\n\n\t\t\ttry {\n\t\t\t\tconst data = await api.category({\n\t\t\t\t\tcategory,\n\t\t\t\t\tsort,\n\t\t\t\t\tleastGreatest,\n\t\t\t\t\toffset: page * LIMIT,\n\t\t\t\t\tlimit: LIMIT,\n\t\t\t\t});\n\n\t\t\t\tsetData(data);\n\t\t\t\tsetLastTotal(data.total);\n\t\t\t} catch (err) {\n\t\t\t\tif (!isAbortError(err)) {\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\tsetError(String(err));\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\n\t\treturn () => abort.abort();\n\t}, [page, category, search, t]);\n\n\tif (error)\n\t\treturn (\n\t\t\t<CommonError\n\t\t\t\tcause={t('theatre:error.category.fetch')}\n\t\t\t\terror={error}\n\t\t\t\tmessage={t('theatre:error.category.generic')}\n\t\t\t/>\n\t\t);\n\n\treturn (\n\t\t<main className={styles.main}>\n\t\t\t<SearchBar\n\t\t\t\tshowCategory={showCategory}\n\t\t\t\tcategory={category}\n\t\t\t\tplaceholder={placeholder}\n\t\t\t/>\n\t\t\t<section>\n\t\t\t\t<div className={styles.name}>\n\t\t\t\t\t<h1>\n\t\t\t\t\t\t<Obfuscated ellipsis>{name}</Obfuscated>\n\t\t\t\t\t</h1>\n\t\t\t\t\t<ThemeSelect\n\t\t\t\t\t\tclassName={styles.sort}\n\t\t\t\t\t\tdefaultValue={search.get('sort')!}\n\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\tsearch.delete('page');\n\t\t\t\t\t\t\tsetSearch({\n\t\t\t\t\t\t\t\t...Object.fromEntries(search),\n\t\t\t\t\t\t\t\tsort: event.target.value,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<option value=\"mostPopular\">{t('theatre:mostPopular')}</option>\n\t\t\t\t\t\t<option value=\"leastPopular\">{t('theatre:leastPopular')}</option>\n\t\t\t\t\t\t<option value=\"nameASC\">{t('theatre:nameASC')}</option>\n\t\t\t\t\t\t<option value=\"nameDES\">{t('theatre:nameDES')}</option>\n\t\t\t\t\t</ThemeSelect>\n\t\t\t\t</div>\n\t\t\t\t<ItemList className={styles.items} items={foundData.entries} />\n\t\t\t</section>\n\t\t\t<div className={clsx(styles.pages, maxPage === 0 && styles.useless)}>\n\t\t\t\t<ChevronLeft\n\t\t\t\t\tclassName={clsx(styles.button, !page && styles.disabled)}\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tif (!isLoading(foundData) && page)\n\t\t\t\t\t\t\tsetSearch({\n\t\t\t\t\t\t\t\t...Object.fromEntries(search),\n\t\t\t\t\t\t\t\tpage: Math.max(page - 1, 0).toString(),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t\t<ChevronRight\n\t\t\t\t\tclassName={clsx(styles.button, page >= maxPage && styles.disabled)}\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tif (!isLoading(foundData) && page < maxPage)\n\t\t\t\t\t\t\tsetSearch({\n\t\t\t\t\t\t\t\t...Object.fromEntries(search),\n\t\t\t\t\t\t\t\tpage: (page + 1).toString(),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</main>\n\t);\n};\n\nexport default Category;\n"],"names":["_interopRequireDefault","require$$0","ChevronRight","default_1","_createSvgIcon","require$$1","_jsxRuntime","require$$2","_default","LIMIT","createLoading","total","loading","i","Category","name","category","placeholder","showCategory","t","useTranslation","search","setSearch","useSearchParams","page","lastTotal","setLastTotal","useState","data","setData","foundData","maxPage","error","setError","useEffect","abort","leastGreatest","sort","api","TheatreAPI","DB_API","err","isAbortError","jsx","CommonError","jsxs","styles","SearchBar","Obfuscated","ThemeSelect","event","ItemList","clsx","ChevronLeft","isLoading"],"mappings":"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","x_google_ignoreList":[0]}